<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ODIN BOSS MONITOR PRO</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8e24aa; --accent: #1e88e5; --bg: #f0f2f5;
            --card: #ffffff; --text: #333; --danger: #ff5252;
            --jotun: #5c6bc0; --nida: #66bb6a; --alf: #ffa726; --muspel: #ef5350;
            --as: #ab47bc; --nifl: #26c6da; --vana: #9ccc65; --dun: #78909c;
        }

        body { font-family: 'Noto Sans KR', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* ì‚¬ì´ë“œë°” ë‚´ë¹„ê²Œì´ì…˜ */
        nav { width: 80px; background: #fff; border-right: 1px solid #ddd; display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 15px; box-shadow: 2px 0 5px rgba(0,0,0,0.05); }
        .nav-item { width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; border-radius: 12px; cursor: pointer; color: #777; transition: 0.3s; font-size: 22px; }
        .nav-item:hover { background: #f0f0f0; color: var(--primary); }
        .nav-item.active { background: var(--primary); color: #fff; box-shadow: 0 4px 10px rgba(142, 36, 170, 0.3); }

        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
        main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        header { height: 60px; background: #fff; border-bottom: 1px solid #ddd; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.3em; color: var(--primary); }
        .content { flex: 1; padding: 25px; overflow-y: auto; box-sizing: border-box; }

        /* íƒ­ë³„ í™”ë©´ ì œì–´ */
        .pane { display: none; }
        .pane.active { display: block; animation: fadeIn 0.4s ease; }

        /* ëŒ€ì‹œë³´ë“œ ì¹´ë“œ ë””ìì¸ */
        .dashboard-grid { display: grid; grid-template-columns: 1fr 350px; gap: 20px; }
        .card { background: var(--card); border-radius: 15px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .focus-card { text-align: center; border: 2px solid var(--accent); }
        .timer-main { font-family: 'Orbitron', sans-serif; font-size: 4em; color: var(--accent); margin: 15px 0; }
        .next-boss-name { font-size: 1.8em; font-weight: bold; }

        /* ë³´ìŠ¤ ìŠ¤ì¼€ì¤„ëŸ¬ í…Œì´ë¸” (ìš”ì²­í•˜ì‹  ìˆœì„œ ì •ë ¬) */
        .world-header { padding: 10px 15px; border-radius: 8px; color: #fff; font-weight: bold; margin: 20px 0 10px 0; display: inline-block; }
        table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 10px; overflow: hidden; }
        th { background: #f8f9fa; padding: 15px; text-align: left; border-bottom: 2px solid #eee; font-size: 0.9em; color: #666; }
        td { padding: 15px; border-bottom: 1px solid #eee; }
        input[type="number"] { width: 80px; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; }
        .apply-btn { background: var(--primary); color: #fff; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; float: right; }

        /* ë¡œê·¸ ë° ê³ ì • ì•Œë¦¼ */
        .log-item { padding: 10px; border-bottom: 1px dashed #eee; font-size: 0.9em; }
        .log-time { color: var(--danger); font-weight: bold; margin-right: 10px; }
        .fixed-alarm-row { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #fcfcfc; border: 1px solid #eee; border-radius: 8px; margin-bottom: 10px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<nav>
    <div class="nav-item active" onclick="tab('dash')">ğŸ </div>
    <div class="nav-item" onclick="tab('sched')">ğŸ“…</div>
    <div class="nav-item" onclick="tab('calc')">ğŸ§®</div>
    <div class="nav-item" onclick="tab('logs')">ğŸ“</div>
    <div class="nav-item" onclick="tab('sets')">âš™ï¸</div>
    <div class="nav-item" onclick="togglePIP()">ğŸ“º</div>
</nav>

<main>
    <header>ODIN BOSS COMMANDER</header>
    <div class="content">
        <div id="dash" class="pane active">
            <div class="dashboard-grid">
                <div>
                    <div class="card focus-card">
                        <div style="color:#888; font-weight:bold;">NEXT TARGET</div>
                        <div class="next-boss-name" id="main-target-name">ëŒ€ê¸° ì¤‘...</div>
                        <div class="timer-main" id="main-timer">00:00:00</div>
                    </div>
                    <div class="card">
                        <h3>Upcoming Bosses</h3>
                        <div id="upcoming-list"></div>
                    </div>
                </div>
                <div>
                    <div class="card" style="height: 100%;">
                        <h3>Event Logs</h3>
                        <div id="log-display"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="sched" class="pane">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h2>Boss Scheduler</h2>
                    <button class="apply-btn" onclick="applyTimers()">ì„¤ì • ì €ì¥ ë° ì ìš©</button>
                </div>
                <div id="scheduler-content"></div>
            </div>
        </div>

        <div id="sets" class="pane">
            <div class="card">
                <h2>ê³ ì • ì•Œë¦¼ (ë°œí• ë¼/ì¹¨ëµì)</h2>
                <div class="fixed-alarm-row"><span>12:00 ëŒ€ë¥™ ì¹¨ëµì</span><input type="checkbox" checked></div>
                <div class="fixed-alarm-row"><span>13:00 ë°œí• ë¼ ëŒ€ì „</span><input type="checkbox" checked></div>
                <div class="fixed-alarm-row"><span>18:00 ë°œí• ë¼ ëŒ€ì „</span><input type="checkbox" checked></div>
                <div class="fixed-alarm-row"><span>20:00 ëŒ€ë¥™ ì¹¨ëµì</span><input type="checkbox" checked></div>
                <div class="fixed-alarm-row"><span>21:00 ë°œí• ë¼ ëŒ€ì „</span><input type="checkbox" checked></div>
            </div>
        </div>
    </div>
</main>

<canvas id="pip-canvas" width="300" height="450" style="display:none;"></canvas>
<video id="pip-video" autoplay muted style="display:none;"></video>

<script>
    // ë„ê· ë‹˜ì´ ì œê³µí•´ì£¼ì‹  ì™„ë²½í•œ ë³´ìŠ¤ ë¦¬ìŠ¤íŠ¸ (ì •ë ¬ ìˆœì„œ ì¤€ìˆ˜)
    const bossDB = [
        { world: "ìš”íˆ°í—¤ì„", color: "var(--jotun)", bosses: ["íŒŒë¥´ë°”", "ì…€ë¡œë¹„ì•„", "íë‹ˆë¥´", "í˜í‹°", "ë°”ìš°í‹°", "ë‹ˆë“œí˜¸ê·¸", "ì•¼ë£¬", "í‹°ë¥´"] },
        { world: "ë‹ˆë‹¤ë²¨ë¦¬ë¥´", color: "var(--nida)", bosses: ["ë¼ì´ë…¸ë¥´", "ë¹„ìš”ë¥¸", "í—¤ë¥´ëª¨ë“œ", "ìŠ¤ì¹¼ë¼ë‹ˆë¥´", "ë¸Œë¥€íë“œ", "ë¼íƒ€í† ìŠ¤í¬", "ìˆ˜ë“œë¦¬", "í† ë¥´"] },
        { world: "ì•Œë¸Œí—¤ì„", color: "var(--alf)", bosses: ["ìŠ¤ë°”ë¥´íŠ¸", "ë‘ë¼ìŠ¤ë¡œë¥´", "ëª¨ë„¤ê°€ë¦„", "ë“œë¼ìš°ê·¸", "êµ´ë² ì´ê·¸", "ì˜¤ë”˜"] },
        { world: "ë¬´ìŠ¤í í—¤ì„", color: "var(--muspel)", bosses: ["ë©”ê¸°ë¥´", "ì‹ ë§ˆë¼", "í—¤ë¥´ê°€ë¦„", "íƒ•ê·¸ë¦¬ìŠ¤ë‹ˆë¥´", "ì—˜ë“œë£¬", "ìš°ë¡œë³´ë¡œìŠ¤", "ìˆ˜ë¥´íŠ¸"] },
        { world: "ì•„ìŠ¤ê°€ë¥´ë“œ", color: "var(--as)", bosses: ["ë°œë¦¬", "ë…¸íŠ¸", "ìƒ¤ë¬´í¬", "ìŠ¤ì¹¼ë“œë©”ë¥´", "í™”ì‹ ê·¸ë¡œì•„", "ë¯¸ë¯¸ë¥´"] },
        { world: "ë‹ˆí”Œí—¤ì„", color: "var(--nifl)", bosses: ["íˆë¡œí‚¨", "í˜¸ë“œ", "í—¤ì´ë“œ", "ëŒ€êµì£¼", "í”„ë ˆì´", "ì´ë¯¸ë¥´"] },
        { world: "ë°”ë‚˜í—¤ì„", color: "var(--vana)", bosses: ["ì—˜ë””ë¥´", "ì•ˆë‚˜ë¥´ì—˜ë””ë¥´", "ìŠ¤ì¿¨ë“œ", "ìŠ¤ì¹´ë””", "ì—ê¸°ë¥´"] },
        { world: "ë˜ì „", color: "var(--dun)", bosses: ["ìµœí•˜ì¸µ êµ´ë² ì´ê·¸", "ìµœí•˜ì¸µ ê°•ê¸€ë¡œí‹°", "ìµœí•˜ì¸µ ìŠ¤ë„¤ë¥´", "4ì¸µ ëª¨ë„¤ê°€ë¦„", "7ì¸µ ë“œë¼ìš°ê·¸", "10ì¸µ ë‹¤ì¸í˜ë¡œí¬"] }
    ];

    let activeTimers = JSON.parse(localStorage.getItem('odin_final_v1')) || [];
    let logs = [];

    function tab(id) {
        document.querySelectorAll('.pane').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function initScheduler() {
        const container = document.getElementById('scheduler-content');
        bossDB.forEach(group => {
            const header = document.createElement('div');
            header.className = 'world-header';
            header.style.backgroundColor = group.color;
            header.innerText = group.world;
            container.appendChild(header);

            const table = document.createElement('table');
            table.innerHTML = `<thead><tr><th>ë³´ìŠ¤ëª…</th><th>ë‚¨ì€ ì‹œê°„(ë¶„)</th><th>ì˜ˆìƒ ì  </th></tr></thead>`;
            const tbody = document.createElement('tbody');
            group.bosses.forEach(name => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${name}</strong></td>
                    <td><input type="number" class="time-input" data-name="${name}" placeholder="ë¶„"></td>
                    <td class="target-time" id="target-${name}">--:--:--</td>
                `;
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
            container.appendChild(table);
        });
    }

    function applyTimers() {
        document.querySelectorAll('.time-input').forEach(input => {
            const val = input.value;
            if(val) {
                const name = input.dataset.name;
                const target = Date.now() + (val * 60000);
                const idx = activeTimers.findIndex(t => t.name === name);
                if(idx > -1) activeTimers[idx].target = target;
                else activeTimers.push({ name, target });
                addLog(`${name} ì„¤ì • ì™„ë£Œ`);
            }
        });
        localStorage.setItem('odin_final_v1', JSON.stringify(activeTimers));
        alert("ëª¨ë“  ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }

    function addLog(msg) {
        const now = new Date().toLocaleTimeString();
        logs.unshift(`<div class="log-item"><span class="log-time">[${now}]</span> ${msg}</div>`);
        document.getElementById('log-display').innerHTML = logs.slice(0, 10).join('');
    }

    function update() {
        const now = Date.now();
        activeTimers.sort((a,b) => a.target - b.target);
        activeTimers = activeTimers.filter(t => t.target - now > -600000);

        if(activeTimers.length > 0) {
            const next = activeTimers[0];
            const diff = next.target - now;
            document.getElementById('main-target-name').innerText = next.name;
            document.getElementById('main-timer').innerText = formatTime(diff);
            document.getElementById('main-timer').style.color = diff < 300000 ? 'var(--danger)' : 'var(--accent)';
        }

        document.getElementById('upcoming-list').innerHTML = activeTimers.slice(1, 8).map(t => `
            <div style="display:flex; justify-content:space-between; padding:12px; border-bottom:1px solid #eee;">
                <span>${t.name}</span>
                <span style="font-weight:bold; color:var(--primary)">${formatTime(t.target - now)}</span>
            </div>
        `).join('');

        drawPIP();
    }

    function formatTime(ms) {
        if(ms < 0) return "ì¶œí˜„ ì¤‘";
        const h = Math.floor(ms/3600000);
        const m = Math.floor((ms%3600000)/60000);
        const s = Math.floor((ms%60000)/1000);
        return `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }

    // PIP ë° ìº”ë²„ìŠ¤ ë¡œì§
    const canvas = document.getElementById('pip-canvas');
    const ctx = canvas.getContext('2d');
    function drawPIP() {
        ctx.fillStyle = "#1a1a2e"; ctx.fillRect(0,0,300,450);
        ctx.fillStyle = "#8e24aa"; ctx.font = "bold 20px Arial"; ctx.fillText("BOSS MONITOR", 15, 40);
        activeTimers.slice(0, 10).forEach((t, i) => {
            const d = t.target - Date.now();
            ctx.fillStyle = d < 300000 ? "#ff5252" : "#00d4ff";
            ctx.font = "16px Arial";
            ctx.fillText(`${t.name.padEnd(8)} ${formatTime(d)}`, 15, 80 + (i*35));
        });
    }

    async function togglePIP() {
        const v = document.getElementById('pip-video');
        if (document.pictureInPictureElement) await document.exitPictureInPicture();
        else { v.srcObject = canvas.captureStream(); await v.play(); await v.requestPictureInPicture(); }
    }

    initScheduler();
    setInterval(update, 1000);
</script>

</body>
</html>
