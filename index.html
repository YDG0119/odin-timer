<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ODIN BOSS COMMANDER</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a12;
            --bg-panel: rgba(30, 35, 50, 0.8);
            --accent-cyan: #00f2ff;
            --accent-gold: #ffd700;
            --accent-danger: #ff2a6d;
            --text-primary: #ffffff;
            --text-secondary: #a0a5b9;
            --glow-shadow: 0 0 10px rgba(0, 242, 255, 0.5);
        }

        body {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark), #1a1a2e);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            box-sizing: border-box;
            /* ë°°ê²½ì— ì€ì€í•œ ë§ˆë²•ì§„ ëŠë‚Œ íŒ¨í„´ (ì„ íƒì‚¬í•­) */
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(0, 242, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 42, 109, 0.05) 0%, transparent 50%);
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            background: var(--bg-panel);
            backdrop-filter: blur(15px); /* ìœ ë¦¬ íš¨ê³¼ */
            padding: 30px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }

        h2 {
            text-align: center;
            font-family: 'Cinzel', serif;
            color: var(--accent-gold);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            font-size: 2em;
        }

        /* ì…ë ¥ ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ë§ */
        .boss-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .boss-row {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            border-left: 3px solid var(--text-secondary);
            transition: all 0.3s ease;
        }

        .boss-row:hover {
            border-left-color: var(--accent-cyan);
            box-shadow: var(--glow-shadow);
            transform: translateY(-2px);
        }

        .boss-row span {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .boss-row .boss-name-title {
            font-size: 1.1em;
            font-weight: bold;
            color: var(--text-primary);
        }

        .boss-row input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #333;
            border-bottom: 2px solid var(--accent-cyan);
            color: var(--accent-cyan);
            padding: 8px 10px;
            border-radius: 4px;
            font-family: 'Orbitron', monospace;
            font-size: 1.1em;
            text-align: center;
            transition: all 0.3s;
            box-sizing: border-box;
        }
        
        .boss-row input:focus {
            outline: none;
            border-bottom-color: var(--accent-gold);
            box-shadow: 0 0 15px rgba(0, 242, 255, 0.3);
        }
        
        .boss-row input::placeholder { color: rgba(255,255,255,0.2); font-size: 0.8em;}

        /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            font-weight: bold;
            font-size: 1em;
            text-transform: uppercase;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-pip {
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            color: white;
            box-shadow: 0 0 20px rgba(0, 198, 255, 0.4);
        }
        
        .btn-reset {
            background: linear-gradient(45deg, #ff4b2b, #ff416c);
            color: white;
            box-shadow: 0 0 20px rgba(255, 75, 43, 0.4);
        }

        button:hover { transform: scale(1.02); filter: brightness(1.2); }
        button:active { transform: scale(0.98); }

        /* íƒ€ì´ë¨¸ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ë§ */
        #timer-display {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .timer-item {
            background: linear-gradient(90deg, rgba(0, 242, 255, 0.1), transparent);
            border-left: 4px solid var(--accent-cyan);
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideIn 0.4s ease-out;
        }

        .timer-item.urgent {
            border-left-color: var(--accent-danger);
            background: linear-gradient(90deg, rgba(255, 42, 109, 0.15), transparent);
            box-shadow: 0 0 15px rgba(255, 42, 109, 0.3) inset;
            animation: pulse 1.5s infinite;
        }
        
        .timer-item .name { font-size: 1.2em; color: var(--text-primary); }
        .timer-item .remaining {
            font-size: 1.5em;
            color: var(--accent-cyan);
            font-weight: bold;
            text-shadow: 0 0 5px var(--accent-cyan);
        }
        .timer-item.urgent .remaining { color: var(--accent-danger); text-shadow: 0 0 5px var(--accent-danger); }

        /* ì• ë‹ˆë©”ì´ì…˜ ë° ê¸°íƒ€ */
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0% { box-shadow: 0 0 15px rgba(255, 42, 109, 0.3) inset; } 50% { box-shadow: 0 0 30px rgba(255, 42, 109, 0.6) inset; } 100% { box-shadow: 0 0 15px rgba(255, 42, 109, 0.3) inset; } }

        #pip-canvas, #pip-video { display: none; }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 600px) {
            .boss-input-grid { grid-template-columns: 1fr 1fr; }
            .timer-item { padding: 10px 15px; }
            .timer-item .name { font-size: 1em; }
            .timer-item .remaining { font-size: 1.2em; }
        }
    </style>
</head>
<body>

<div class="container">
    <h2>âš”ï¸ ODIN BOSS COMMANDER âš”ï¸</h2>

    <div class="boss-input-grid" id="input-fields">
        </div>

    <div class="controls">
        <button class="btn-pip" onclick="togglePIP()">ğŸ“º PIP ëª¨ë“œ ì‹¤í–‰</button>
        <button class="btn-reset" onclick="resetAll()">ğŸ”„ ì „ì²´ ì´ˆê¸°í™”</button>
    </div>

    <div id="timer-display">
        </div>
</div>

<video id="pip-video" autoplay muted></video>
<canvas id="pip-canvas" width="300" height="400"></canvas>

<script>
    // =============================================
    // [ì„¤ì • ì˜ì—­] ë³´ìŠ¤ ì´ë¦„ê³¼ ë¦¬ì   ì£¼ê¸°(ë¶„)ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.
    // =============================================
    const bossData = [
        { name: "í˜í‹°", regen: 720 },      // 12ì‹œê°„
        { name: "ë°”ìš°í‹°", regen: 120 },    // 2ì‹œê°„
        { name: "ë‹ˆë“œí˜¸ê·¸", regen: 1440 }, // 24ì‹œê°„
        { name: "ì•¼ë£¬", regen: 240 },      // 4ì‹œê°„
        { name: "ëª¨ë„¤ê°€ë¦„", regen: 120 },  // 2ì‹œê°„
        { name: "ë¼íƒ€í† ìŠ¤í¬", regen: 240 } // 4ì‹œê°„
    ];
    // =============================================


    let activeTimers = [];

    // 2. ì…ë ¥ í•„ë“œ ìƒì„± (ë””ìì¸ ê°œì„ )
    const inputGrid = document.getElementById('input-fields');
    bossData.forEach((boss, index) => {
        const div = document.createElement('div');
        div.className = 'boss-row';
        div.innerHTML = `
            <div>
                <span class="boss-name-title">${boss.name}</span>
                <span>(ì£¼ê¸°: ${boss.regen/60}ì‹œê°„)</span>
            </div>
            <input type="number" placeholder="ë‚¨ì€ ë¶„ ì…ë ¥" onchange="setTimer(${index}, this.value)">
        `;
        inputGrid.appendChild(div);
    });

    // 3. íƒ€ì´ë¨¸ ì„¤ì • í•¨ìˆ˜
    function setTimer(index, leftMins) {
        if (!leftMins || leftMins < 0) return;
        const now = new Date();
        // ì…ë ¥ë°›ì€ 'ë‚¨ì€ ì‹œê°„'ì„ ë”í•´ì„œ íƒ€ê²Ÿ ì‹œê°„ ì„¤ì •
        const targetTime = new Date(now.getTime() + leftMins * 60000);
        
        const existing = activeTimers.find(t => t.name === bossData[index].name);
        if (existing) {
            existing.target = targetTime;
        } else {
            activeTimers.push({ name: bossData[index].name, target: targetTime });
        }
        renderTimers();
        // ì…ë ¥ í›„ ê°’ ë¹„ìš°ê¸° (ì„ íƒì‚¬í•­)
        // document.querySelectorAll('.boss-row input')[index].value = ''; 
    }

    // 4. í™”ë©´ ë Œë”ë§ ë° PIP ìº”ë²„ìŠ¤ ê·¸ë¦¬ê¸°
    function renderTimers() {
        const display = document.getElementById('timer-display');
        activeTimers.sort((a, b) => a.target - b.target);
        
        display.innerHTML = '';
        const now = new Date();

        activeTimers.forEach(timer => {
            const diff = timer.target - now;
            
            // ì´ë¯¸ ì§€ë‚œ ë³´ìŠ¤ëŠ” ëª©ë¡ì—ì„œ ì œê±° (ì˜µì…˜)
            // if (diff < -60000) { return; } 

            const hours = Math.floor(diff / 3600000);
            const mins = Math.floor((diff % 3600000) / 60000);
            const secs = Math.floor((diff % 60000) / 1000);
            
            let timeText = "ì   í™•ì¸ í•„ìš”!";
            if (diff > 0) {
                 timeText = `${hours > 0 ? hours + 'ì‹œê°„ ' : ''}${mins}ë¶„ ${secs}ì´ˆ`;
            }
            
            const item = document.createElement('div');
            // 5ë¶„(300000ms) ë¯¸ë§Œì´ë©´ urgent í´ë˜ìŠ¤ ì¶”ê°€
            item.className = `timer-item ${diff > 0 && diff < 300000 ? 'urgent' : ''}`;
            item.innerHTML = `
                <div class="name">${timer.name}</div>
                <div class="remaining">${timeText}</div>
            `;
            display.appendChild(item);
        });

        drawCanvas(); // PIP ìº”ë²„ìŠ¤ ì—…ë°ì´íŠ¸
    }

    // 5. PIP ìº”ë²„ìŠ¤ ê·¸ë¦¬ê¸° (ë””ìì¸ ê°œì„ )
    const canvas = document.getElementById('pip-canvas');
    const ctx = canvas.getContext('2d');
    const video = document.getElementById('pip-video');

    function drawCanvas() {
        // ë°°ê²½ (ì–´ë‘ìš´ ë‚¨ìƒ‰)
        ctx.fillStyle = "#0a0a12";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // ì œëª©
        ctx.fillStyle = "#ffd700"; // ê³¨ë“œ
        ctx.font = "bold 24px Orbitron";
        ctx.textAlign = "center";
        ctx.fillText("ODIN COMMANDER", canvas.width / 2, 35);
        
        // êµ¬ë¶„ì„ 
        ctx.strokeStyle = "#00f2ff";
        ctx.beginPath(); ctx.moveTo(20, 50); ctx.lineTo(280, 50); ctx.stroke();

        // íƒ€ì´ë¨¸ ë¦¬ìŠ¤íŠ¸
        ctx.textAlign = "left";
        activeTimers.forEach((t, i) => {
            if (i > 6) return; // ê³µê°„ ë¶€ì¡± ì‹œ ìµœëŒ€ 7ê°œê¹Œì§€ë§Œ í‘œì‹œ

            const diff = t.target - new Date();
            const hours = Math.floor(diff / 3600000);
            const mins = Math.floor((diff % 3600000) / 60000);
            const secs = Math.floor((diff % 60000) / 1000);
            
            let timeStr = "ì¶œí˜„ ì¤‘!";
            if (diff > 0) {
                 timeStr = `${hours > 0 ? hours + ':' : ''}${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            }

            const yPos = 90 + (i * 40);
            
            // ì„ë°• ì‹œ ë¶‰ì€ìƒ‰, í‰ì†Œ í˜•ê´‘ í•˜ëŠ˜ìƒ‰
            ctx.fillStyle = (diff > 0 && diff < 300000) ? "#ff2a6d" : "#00f2ff";
            ctx.font = "bold 20px Orbitron";
            ctx.fillText(t.name, 20, yPos);
            
            ctx.textAlign = "right";
            ctx.fillText(timeStr, 280, yPos);
            ctx.textAlign = "left";
        });
    }

    async function togglePIP() {
        try {
            if (document.pictureInPictureElement) {
                await document.exitPictureInPicture();
            } else {
                const stream = canvas.captureStream(30); // 30fps
                video.srcObject = stream;
                // video.play()ëŠ” ëª¨ë°”ì¼ ì •ì±…ìƒ ì‚¬ìš©ì ì œìŠ¤ì²˜ í•„ìš”í•  ìˆ˜ ìˆìŒ
                await video.play().then(() => video.requestPictureInPicture());
            }
        } catch (error) {
            console.error(error);
            alert("PIP ëª¨ë“œ ì‹¤í–‰ ì‹¤íŒ¨. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.\n(ì¼ë¶€ ë¸Œë¼ìš°ì €ëŠ” ì§€ì›í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)");
        }
    }

    function resetAll() {
        if(confirm("ëª¨ë“  íƒ€ì´ë¨¸ë¥¼ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            activeTimers = [];
            document.querySelectorAll('input').forEach(i => i.value = '');
            renderTimers();
        }
    }

    // 1ì´ˆë§ˆë‹¤ í™”ë©´ ê°±ì‹ 
    setInterval(renderTimers, 1000);
</script>
</body>
</html>